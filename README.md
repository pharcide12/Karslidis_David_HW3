Этот репозиторий содержит выполненное домашнее задание №3 
В работе представлены SQL-скрипты для анализа данных о клиентах, заказах и транзакциях, а также решения с использованием агрегирующих и оконных функций.
Файл:
	•	Karslidis_David_HW3.sql — полный SQL-скрипт со всеми запросами домашнего задания.

**Файл включает восемь задач, каждая из которых оформлена отдельным блоком с комментариями.**



 Выполненные задачи

1. Распределение клиентов по сферам деятельности

Группировка по job_industry_category и подсчёт количества клиентов в каждой категории.

2. Доход по месяцам и сферам

CTE с расчётом суммы заказа и последующей агрегацией по году, месяцу и индустрии.

3. Онлайн-заказы IT-клиентов

Подсчёт количества онлайн-заказов по брендам среди клиентов из категории “IT”.

4. Метрики по клиентам

Вариант A: с временной таблицей
Вариант B: через оконные функции
Рассчитаны:
	•	общий доход клиента
	•	min / max заказ
	•	средний чек
	•	количество заказов

5. Топ-3 клиентов с минимальным и максимальным доходом

Использованы оконные функции RANK() и работа с ранжированием.

6. Только вторые транзакции клиентов

Определение порядка заказов через ROW_NUMBER().

7. Максимальный интервал между заказами

Оконная функция LAG() и поиск максимального интервала между двумя заказами клиента.

8. Топ-5 клиентов в каждом сегменте благосостояния

Разбиение по wealth_segment, расчёт дохода и выборка топ-клиентов внутри каждого сегмента.
